var APP
!function(t){var e=WUX.WUtil,i=function(i){function o(t){return i.call(this,t||"*","GUIAdminUte")||this}return __extends(o,i),o.prototype.render=function(){var i=this
this.fpFilter=new WUX.WFormPanel("fpFilter"),this.fpFilter.addRow(),this.fpFilter.addComponent("idRuolo","Ruolo",new t.APPSelRuoloUte),this.fpFilter.addTextField("email","Email"),this.fpFilter.addTextField("telefono","Telefono"),this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY,"width: 160px"),this.btnFind.on("click",function(t){if(i.fpFilter.isBlank())return void WUX.showWarning("Specificare almeno un criterio di ricerca.")
var e=i.fpFilter.checkMandatory(!0,!0,!0)
if(e)return void WUX.showWarning("Specificare almeno uno dei seguenti campi: "+e)
jrpc.execute("UTENTI.find",[i.fpFilter.getState()],function(t){i.tabResult.setState(t),t&&t.length?WUX.showSuccess(t.length+" record trovati"):WUX.showWarning("Nessun record trovato")})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY,"width: 160px"),this.btnReset.on("click",function(t){i.fpFilter.clear(),i.tabResult.setState([]),i.fpFilter.focus()}),this.btnToggle=new WUX.WButton(this.subId("bt"),t.TXT.ENABLE,WUX.WIcon.THUMBS_O_UP,WUX.BTN.ACT_OUTLINE_DANGER),this.btnToggle.on("click",function(o){i.btnToggle.blur()
var n=i.tabResult.getSelectedRowsData()
if(!n||!n.length)return void WUX.showWarning("Selezione l'elemento da abilitare / disabilitare")
var r=e.getString(n[0],"id"),a=e.getBoolean(n[0],"attivo"),s=!a
r&&jrpc.execute("UTENTI.setEnabled",[r,s],function(e){if(!e)return void WUX.showWarning("Utente non aggiornato.")
s?i.btnToggle.setText(t.TXT.DISABLE,WUX.WIcon.THUMBS_O_DOWN):i.btnToggle.setText(t.TXT.ENABLE,WUX.WIcon.THUMBS_O_UP)
var o=i.tabResult.getSelectedRows()
if(o&&o.length){var n=i.tabResult.getState(),r=o[0]
n[r].attivo=s,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([r])},100)}})}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnToggle)
var o=[["Username","id","s"],["Ruolo","idRuolo","s"],["Email","email","s"],["Telefono","telefono","s"],["Verificato","verificato","b"],["Attivo","attivo","b"],["Primo Accesso","dtpa","t"],["Ultimo Accesso","dtua","t"],["Accesso","dta","t"]]
return this.tabResult=new WUX.WDXTable(this.subId("tab"),e.col(o,0),e.col(o,1)),this.tabResult.types=e.col(o,2),this.tabResult.css({h:400}),this.tabResult.onRowPrepared(function(t){if(t.data){var i=e.getBoolean(t.data,"verificato")
e.getBoolean(t.data,"attivo")?i||WUX.setCss(t.rowElement,WUX.CSS.WARNING):WUX.setCss(t.rowElement,WUX.CSS.ERROR)}}),this.tabResult.onSelectionChanged(function(o){var n=e.getFirst(i.tabResult.getSelectedRowsData(),0)
if(n){e.getBoolean(n,"attivo")?i.btnToggle.setText(t.TXT.DISABLE,WUX.WIcon.THUMBS_O_DOWN):i.btnToggle.setText(t.TXT.ENABLE,WUX.WIcon.THUMBS_O_UP)}}),this.tabResult.filter=!0,this.tabResult.exportFile="utenti",this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addRow().addCol("col-md-10").section("Filtro").add(this.fpFilter).addCol("col-md-2").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).addRow().addGroup({classStyle:"table-result-wrapper"},this.cntActions,this.tabResult),this.container},o}(WUX.WComponent)
t.GUIAdminUte=i}(APP||(APP={}))
var APP
!function(t){function e(){var t=window?window._userLogged:void 0
return t&&"object"==typeof t?t:{userName:"public",tokenId:"public"}}function i(t){if(t){var e=t instanceof WUX.WComponent?t.getRoot():t
e&&e.length&&$(window).scrollTop(e.offset().top-300)}}function o(t,e,i){var o=WUX.getId(t)
if(!o)return!0
var n=t instanceof WUX.WComponent?t:WUX.getComponent(t),r=n?n.getRoot():$("#"+o)
if(!r||!r.length)return!0
var a=n?n.getState():"checkbox"==r.attr("type")?r.prop("checked"):r.val(),s=$("#"+o+"-error")
return a?(s.length&&s.remove(),!0):(e||(e="Campo obbligatorio."),"-"!=e&&(s.length?(s.html(e),s.show(),i&&(n?n.focus():r.focus()),!1):(r.parent().append('<label id="'+o+'-error" class="error active" for="'+o+'">'+e+"</label>"),i&&(n?n.focus():r.focus()),!1)))}function n(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i]
t||(t="")
var o="",n=WUX.cls.apply(WUX,e),r=WUX.css.apply(WUX,e)
return n&&(o+=' class="'+n+'"'),r&&(o+=' style="'+r+'"'),"<label"+o+">"+t+"</label>"}t.STATUS_STARTUP=0,t.STATUS_VIEW=1,t.STATUS_EDITING=2,t.getUserLogged=e
var r=function(){function t(){}return t.ID="id",t.DESCRIZIONE="des",t.DESCRIZ_ALT="alt",t.ID_GRUPPO="idg",t.DES_GRUPPO="deg",t.DETTAGLIO="det",t.ANAGRAFICHE="ana",t.ALLEGATO="all",t.ATTIVO="att",t}()
t.ITabella=r,t.scrollTo=i,t.check=o,t.label=n}(APP||(APP={}))
var jrpc=new JRPC("/webapp-bs-it/rpc")
jrpc.setToken(APP.getUserLogged().tokenId)
var APP
!function(t){var e=WUX.WUtil,i=function(t){function i(e,i,o,n,r){var a=t.call(this,e||"*","Chart",i,o,n,r)||this
return a.labels=!1,a.forceOnChange=!0,a}return __extends(i,t),i.prototype.updateState=function(i){if(t.prototype.updateState.call(this,i),this.source=[],this.series=[],this.state){var o=this.state.data
if(o&&o.length){var n=this.state.series,r=this.state.values
if(r){var a=this.state.arguments
if(a){var s=this.state.argType,l=!n||n==a
l&&this.series.push({valueField:"s0",name:this.sTitle?this.sTitle:n})
for(var p=[],h=[],u=0,c=o;u<c.length;u++){var d=c[u]
if(!l){var f=d[n]
if(f&&p.indexOf(f)<0){var g=p.length
p.push(f),this.series.push({valueField:"s"+g,name:f})}}var m=d[a]
m&&h.indexOf(m)<0&&h.push(m)}for(var v=0,E=h;v<E.length;v++){var S=E[v],T={}
if("d"==s){var A=e.toDate(S)
T.a=A?WUX.formatDate(A):S}else T.a=S
for(var R=0,y=o;R<y.length;R++){var d=y[R],m=d[a]
if(m==S){var P=d[r]
if(P||(P=0),l)T.s0=P
else{var f=d[n],g=p.indexOf(f)
if(g<0)continue
T["s"+g]=P}}}this.source.push(T)}}}}}},i.prototype.componentDidMount=function(){this._tooltip&&this.root.attr("title",this._tooltip),this.title||(this.title=""),this.source||(this.source=[]),this.series||(this.series=[]),this.props||(this.props="bar")
var t={dataSource:this.source,commonSeriesSettings:{argumentField:"a",type:this.props,label:{visible:this.labels},point:{symbol:this.pSymbol,size:this.pSize,visible:this.pVisible}},series:this.series,title:this.title,legend:{verticalAlignment:"bottom",horizontalAlignment:"center"},export:{enabled:!0},tooltip:{enabled:!0}}
this.palette&&(t.palette=this.palette),this.xRotate&&(t.argumentAxis={label:{displayMode:"rotate",rotationAngle:this.xRotate}}),this.subTitle&&(t.title={text:this.title,subtitle:{text:this.subTitle}}),this.xTitle&&(t.argumentAxis={title:{text:this.xTitle}}),this.yTitle&&(t.valueAxis={title:{text:this.yTitle}}),$("#"+this.id).dxChart(t)},i.prototype.getInstance=function(t){return this.mounted?(t&&this.root.dxChart(t),this.root.dxChart("instance")):null},i}(WUX.WComponent)
t.Chart=i
var o=function(t){function i(e,i,o,n,r){var a=t.call(this,e||"*","PieChart",i,o,n,r)||this
return a.labels=!1,a.forceOnChange=!0,a}return __extends(i,t),i.prototype.updateState=function(i){if(t.prototype.updateState.call(this,i),this.source=[],this.series=[],this.state){var o=this.state.data
if(o&&o.length){var n=this.state.values
if(n){var r=this.state.arguments
if(r||this.state.series,r){for(var a=[],s={},l=0,p=0,h=o;p<h.length;p++){var u=h[p],c=e.getNumber(u,n)
l+=c
var d=e.getString(u,r)
if(d){a.indexOf(d)<0&&a.push(d)
var f=e.getNumber(s,d)
s[d]=f+c}}for(var g=0,m=a;g<m.length;g++){var d=m[g],c=e.getNumber(s,d),v=l?100*c/l:0
this.source.push({a:d,v:e.round2(v)})}this.series.push({argumentField:"a",valueField:"v",label:{visible:this.labels,connector:{visible:this.labels,width:1}}})}}}}},i.prototype.componentDidMount=function(){this._tooltip&&this.root.attr("title",this._tooltip),this.title||(this.title=""),this.source||(this.source=[]),this.series||(this.series=[]),this.props||(this.props="pie")
var t={dataSource:this.source,series:this.series,title:this.title,legend:{verticalAlignment:"bottom",horizontalAlignment:"center"},export:{enabled:!0},tooltip:{enabled:!0}}
this.palette&&(t.palette=this.palette),this.subTitle&&(t.title={text:this.title,subtitle:{text:this.subTitle}}),$("#"+this.id).dxPieChart(t)},i.prototype.getInstance=function(t){return this.mounted?(t&&this.root.dxPieChart(t),this.root.dxPieChart("instance")):null},i}(WUX.WComponent)
t.PieChart=o}(APP||(APP={}))
var APP
!function(t){var e=WUX.WUtil,i=function(t){function e(e){var i=t.call(this,e,"AppTableActions",null,"table-actions-wrapper")||this
return i.left=new WUX.WContainer(i.subId("l"),"left-actions"),i.right=new WUX.WContainer(i.subId("r"),"right-actions"),i}return __extends(e,t),e.prototype.componentDidMount=function(){var t=$('<div class="table-actions clearfix"></div>')
this.root.append(t),this.noActions||(this.left.mount(t),this.right.mount(t))},e}(WUX.WComponent)
t.AppTableActions=i
var o=function(t){function i(e,i){return t.call(this,e,"APPPeriodi",i)||this}return __extends(i,t),i.prototype.clear=function(){return this.setState(null),this},i.prototype.setDefaults=function(){return this.fp.clear(),this.fp.setValue("d0",e.getCurrDate()),this.fp.setValue("a0",e.getCurrDate(0,0,1,!1,!0)),this},i.prototype.render=function(){this.props||(this.props=1),this.fp=new WUX.WFormPanel(this.subId("fp")),this.fp.nextOnEnter=!0
for(var t=0;t<this.props;t++)this.fp.addRow(),this.fp.addDateField("d"+t,"Dal &nbsp;"+WUX.buildIcon(WUX.WIcon.TRASH,"","",0,"active-cell")),this.fp.addDateField("a"+t,"Al"),this.fp.addDateField("e"+t,"Escluso dal &nbsp;"+WUX.buildIcon(WUX.WIcon.TRASH,"","",0,"active-cell")),this.fp.addDateField("f"+t,"fino al"),this.fp.setTooltip("d"+t,"Dalla data"),this.fp.setTooltip("e"+t,"Escluso dal")
return this.fp},i.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props||(this.props=1)
for(var e=0;e<this.props;e++)this.createLinks(e)},i.prototype.createLinks=function(t){var e=this,i=this.fp.getField("d"+t)
if(i){var o=$('label[for="'+i.id+'"]')
o.length&&(o.css("cursor","pointer"),o.on("click",function(i){e.fp.setValue("d"+t,null),e.fp.setValue("a"+t,null)}))}var n=this.fp.getField("e"+t)
if(n){var r=$('label[for="'+n.id+'"]')
r.length&&(r.css("cursor","pointer"),r.on("click",function(i){e.fp.setValue("e"+t,null),e.fp.setValue("f"+t,null)}))}},i.prototype.getState=function(){if(this.state=[],!this.props)return this.state
for(var t=0,i=this.fp.getState(),o=0;o<this.props;o++){var n=e.getDate(i,"d"+o),r=e.getDate(i,"a"+o),a=e.getDate(i,"e"+o),s=e.getDate(i,"f"+o)
if(n&&r){t++
var l={}
l.id=e.toNumber(n)+"_"+e.toNumber(r),l.data_inizio=n,l.data_fine=r,l.esc_periodo=!1,l.riga=t,this.state.push(l)}if(a&&s){t++
var p={}
p.id=e.toNumber(a)+"_"+e.toNumber(s),p.data_inizio=a,p.data_fine=s,p.esc_periodo=!0,p.riga=t,this.state.push(p)}}return this.state},i.prototype.updateState=function(i){if(t.prototype.updateState.call(this,i),this.fp.clear(),!e.isEmpty(this.state)){for(var o={},n=-1,r=0;r<this.state.length;r++){var a=this.state[r]
if(a){var s=e.getDate(a,"data_inizio"),l=e.getDate(a,"data_fine"),p=e.getBoolean(a,"esc_periodo")
p||s&&l&&(n++,o["d"+n]=s,o["a"+n]=l)}}for(var r=0;r<this.state.length;r++){var a=this.state[r]
if(a){var s=e.getDate(a,"data_inizio"),l=e.getDate(a,"data_fine"),p=e.getBoolean(a,"esc_periodo")
p&&s&&l&&(n=this.idxe(o,s),o["e"+n]=s,o["f"+n]=l)}}this.fp.setState(o)}},i.prototype.idxe=function(t,i){for(var o=e.toNumber(i),n=-1,r=0;r<this.props;r++){var a=e.toNumber(t["e"+r]),s=e.toNumber(t["f"+r])
if(o>=a&&o<=s){n=r
break}}n<0&&(n=0)
for(var r=n;r<this.props;r++)if(!t["e"+r])return r
return 0},i}(WUX.WComponent)
t.APPPeriodi=o
var n=function(t){function e(e,i){var o=t.call(this,e,[],i)||this
return o.name="APPSelRuoloUte",o.options=[{id:"",text:""},{id:"admin",text:"Amministratore"},{id:"user",text:"Ruolo Base"}],o}return __extends(e,t),e}(WUX.WSelect2)
t.APPSelRuoloUte=n
var r=function(t){function e(e,i){var o=t.call(this,e,[],i)||this
return o.name="APPSelComune",o}return __extends(e,t),e.prototype.componentDidMount=function(){var t={ajax:{dataType:"json",delay:400,processResults:function(t,e){return{results:t}},transport:function(t,e,i){jrpc.execute("COMUNI.lookup",[t.data],e)}},placeholder:"",allowClear:!0,minimumInputLength:3}
this.init(t)},e}(WUX.WSelect2)
t.APPSelComune=r
var a=function(t){function e(e,i,o){var n=t.call(this,e||"*","APPArticle",i,"page type-page status-publish hentry")||this
return n.rootTag="article",o&&(n.state=[],n.state.push(o)),n}return __extends(e,t),e.prototype.render=function(){var t='<header class="header">'
if(this.props&&(t+='<h1 class="entry-title">'+this.props+"</h1>"),t+='<section class="entry-content"><div class="textwidget">',this.state)for(var e=0,i=this.state;e<i.length;e++){var o=i[e]
t+=o?"<p>"+o+"</p>":"<p>&nbsp;</p>"}return this.addSignature&&(t+="<p>Have fun,</p>",t+="<p>&nbsp;</p>",t+="<p><em>Staff</em></p>"),t+="</div></section>",this.buildRoot(this.rootTag,t)},e}(WUX.WComponent)
t.APPArticle=a
var s=function(t){function e(e,i,o,n,r,a){var s=t.call(this,e||"*","APPBtnAttach",i,n,r,a)||this
return s._icon=o,s}return __extends(e,t),e.prototype.render=function(){var t=WUX.buildIcon(this._icon)
t&&(t+=" "),this._classStyle?this._classStyle.indexOf("dropdown-toggle")<0&&(this._classStyle+=" dropdown-toggle"):this._classStyle="btn btn-primary dropdown-toggle"
var e=$(WUX.build("div","",this._style,this._attributes,this.id,"btn-group"))
return e.append(WUX.build("button",t+this.props+' &nbsp;<i class="fa fa-caret-down"></i>',"",'data-toggle="dropdown" aria-expanded="false"',"",this._classStyle)),this._$u=$('<ul class="dropdown-menu"></ul>'),e.append(this._$u),this.readOnly||(this.addItem('<i class="fa fa-upload"></i> &nbsp;Importa',"i"),this.addItem('<i class="fa fa-eraser"></i> &nbsp;Rimuovi',"r")),this.addItem('<i class="fa fa-eye"></i> &nbsp;Vedi',"v"),e},e.prototype.addItem=function(t,e){var i=this
if(this._$u){var o=$("<li></li>")
this._$u.append(o)
var n=$("<a>"+t+"</a>")
o.append(n),n.click(function(){i.setState(e)})}},e.prototype.pop=function(){var t=this.state
return this.state=null,t},e}(WUX.WComponent)
t.APPBtnAttach=s}(APP||(APP={}))
var APP
!function(t){var e=WUX.WUtil,i=function(t){function i(e,i,o,n){var r=t.call(this,e||"*","OLMap",null,i,o||"width:100%;height:600px",n)||this
return r.imgs="/webapp-bs-it/img/",r.pdx=0,r.pdy=0,r._cfg={},r.markers=[],r.mrkFea=[],r.polygons=[],r.polFea=[],r}return __extends(i,t),Object.defineProperty(i.prototype,"cfg",{get:function(){return this._cfg},set:function(t){this._cfg=t},enumerable:!1,configurable:!0}),i.prototype.clear=function(){this.clearMarkers(),this.clearPolygons()},i.prototype.clearMarkers=function(){this.markers=[],this.mrkFea=[],this.mounted&&this.mrkLay&&(this.map.removeLayer(this.mrkLay),this.mrkSrc=null,this.mrkLay=null,this.hidePopup())},i.prototype.clearPolygons=function(){this.polygons=[],this.polFea=[],this.mounted&&this.polLay&&(this.map.removeLayer(this.polLay),this.polSrc=null,this.polLay=null,this.hidePopup())},i.prototype.addMarker=function(t,e,i,o,n,r){this.markers.push([t,e,i,o,n,r]),this.mounted&&(this.hidePopup(!1),this._addMarker(t,e,i,o))},i.prototype.addPolygon=function(t,e,i,o,n,r){this.polygons.push([t,e,i,o,n,r]),this.mounted&&(this.hidePopup(!1),this._addPolygon(t,e,i,o))},i.prototype.addGeometry=function(t,i,o,n,r){if(t)try{var a=JSON.parse(t)
if(!a)return
var s=e.getString(a,"type")
if(!s)return
var l=e.getArray(a,"coordinates")
if(!l||!l.length)return
"Point"==s?this.addMarker(l[0],l[1],i,o,n,r):this.addPolygon(s,l,i,o,n,r)}catch(e){console.error(e+" in addGeometry "+t)}},i.prototype.inflate=function(t,e){if(!(t<0&&t>=this.mrkFea.length)){var i=this.markers[t],o=this.mrkFea[t]
if(i&&o){var n=i[3]
e&&(n=e),n||(n="blue"),o.setStyle(new ol.style.Style({image:new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",src:this.imgs+"marker-"+n+".png",scale:1})}))}}},i.prototype.deflate=function(t,e){if(!(t<0&&t>=this.mrkFea.length)){var i=this.markers[t],o=this.mrkFea[t]
if(i&&o){var n=i[3]
e&&(n=e),n||(n="blue"),o.setStyle(new ol.style.Style({image:new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",src:this.imgs+"marker-"+n+".png",scale:.6})}))}}},i.prototype.center=function(t,e,i){this.hidePopup(!0),(t||e)&&(this.view?(this.view.setCenter(ol.proj.fromLonLat([t,e])),this.view.setZoom(i)):(this._cfg.lon=t,this._cfg.lat=e,this._cfg.zoom=i))},i.prototype.centerOn=function(t,i){void 0===i&&(i=16)
var o=0,n=0
if("number"==typeof t){if(!this.markers)return
if(t<0||t>=this.markers.length)return
var r=this.markers[t]
o=r[0],n=r[1]}else o=e.getNumber(t,"lon"),n=e.getNumber(t,"lat");(o||n)&&this.center(o,n,i)},i.prototype.hidePopup=function(t){if(this.$popup.popover("hide"),this.popupn="",t){this.map.removeOverlay(this.popup),this.$popup.remove()
var e=""
this.pdx&&(e+="margin-left:"+this.pdx+"px;"),this.pdy&&(e+="margin-top:"+this.pdy+"px;"),e&&(e=' style="'+e+'"'),this.$popup=$('<div id="'+this.subId("man-popup")+'"'+e+"></div>").appendTo("body"),this.popup=new ol.Overlay({element:this.$popup.get(0),positioning:"bottom-center",stopEvent:!1}),this.map.addOverlay(this.popup)}},i.prototype.showPopup=function(t,e){void 0===e&&(e="top")
var i="",o=t?this.map.forEachFeatureAtPixel(t.pixel,function(t){return t}):null
return o&&(i=o.get("name"))==this.popupn?i:(this.popupn&&this.hidePopup(!0),this.popupn=i,i&&(this.popup.setPosition(t.coordinate),this.$popup.popover({placement:e,html:!0,content:i}),this.$popup.popover("show")),i)},i.prototype.hexToRgba=function(t,e){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t)
if(!i)return""
var o=parseInt(i[1],16),n=parseInt(i[2],16),r=parseInt(i[3],16)
return e||(e="1.0"),"rgba("+o+","+n+","+r+","+e+")"},i.prototype.componentDidMount=function(){var t=this
if(this._cfg.lon||(this._cfg.lon=12.4846),this._cfg.lat||(this._cfg.lat=41.8977),this._cfg.zoom||(this._cfg.zoom=9),this.share?this.share.view?this.view=this.share.view:(this.view=new ol.View({center:ol.proj.fromLonLat([this._cfg.lon,this._cfg.lat]),zoom:this._cfg.zoom}),this.share.view=this.view):this.view=new ol.View({center:ol.proj.fromLonLat([this._cfg.lon,this._cfg.lat]),zoom:this._cfg.zoom}),this._cfg.controls&&(this.controls=ol.control.defaults.defaults(this._cfg.controls)),this._cfg.interactions&&(this.interactions=ol.interaction.defaults.defaults(this._cfg.interactions)),this.map=new ol.Map({target:this.id,layers:[new ol.layer.Tile({source:new ol.source.OSM})],view:this.view,controls:this.controls,interactions:this.interactions}),this.$popup=$("#"+this.subId("man-popup")),!this.$popup.length){var e=""
this.pdx&&(e+="margin-left:"+this.pdx+"px;"),this.pdy&&(e+="margin-top:"+this.pdy+"px;"),e&&(e=' style="'+e+'"'),this.$popup=$('<div id="'+this.subId("man-popup")+'"'+e+"></div>").appendTo("body")}if(this.popup=new ol.Overlay({element:this.$popup.get(0),positioning:"bottom-center",stopEvent:!1}),this.map.addOverlay(this.popup),this.map.on("click",function(e){t.hidePopup(!0)
var i=t.map.forEachFeatureAtPixel(e.pixel,function(t){return t}),o=t.getMarker(i)
if(o){var n=o[5]
n&&(e.lon=o[0],e.lat=o[1],e.name=o[2],n(e))}var r=t.getPolygon(i)
if(r){var n=r[5]
n&&n(e)}}),this.map.on("pointermove",function(e){var i=document.getElementById(t.map.getTarget()),o=t.map.forEachFeatureAtPixel(e.pixel,function(t){return t}),n=t.getMarker(o),r=!1
if(n){var a=n[4]
n[5]&&(r=!0),a&&(e.lon=n[0],e.lat=n[1],e.name=n[2],a(e))}var s=t.getPolygon(o)
if(s){var a=s[4]
s[5]&&(r=!0),a&&a(e)}i.style.cursor=r?"pointer":""}),this.markers)for(var i=0,o=this.markers;i<o.length;i++){var n=o[i]
this._addMarker(n[0],n[1],n[2],n[3])}if(this.polygons)for(var r=0,a=this.polygons;r<a.length;r++){var s=a[r]
this._addPolygon(s[0],s[1],s[2],s[3])}},i.prototype.getMarker=function(t){if(t&&this.markers){var i=t.get("name"),o=e.indexOf(this.markers,2,i)
if(o>=0)return this.markers[o]}return null},i.prototype.getPolygon=function(t){if(t&&this.polygons){var i=t.get("name"),o=e.indexOf(this.polygons,2,i)
if(o>=0)return this.polygons[o]}return null},i.prototype._addMarker=function(t,e,i,o){var n=new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([t,e])),name:i})
o||(o="blue"),n.setStyle(new ol.style.Style({image:new ol.style.Icon({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",src:this.imgs+"marker-"+o+".png",scale:.6})})),this.mrkFea.push(n),this.mrkSrc&&this.mrkLay?this.mrkSrc.addFeature(n):(this.mrkSrc=new ol.source.Vector({features:this.mrkFea}),this.mrkLay=new ol.layer.Vector({source:this.mrkSrc}),this.map.addLayer(this.mrkLay))},i.prototype._addPolygon=function(t,i,o,n){t||(t="MultiPolygon"),n||(n="#ff0000")
var r
"Polygon"==t?(e.starts(n,"#")&&(n=this.hexToRgba(n,"0.4")),i=this.fromLonLat(i,3),r=new ol.Feature({geometry:new ol.geom.Polygon(i),name:o}),r.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:"black",width:1}),fill:new ol.style.Fill({color:n})}))):"LineString"==t?(i=this.fromLonLat(i,2),r=new ol.Feature({geometry:new ol.geom.LineString(i),name:o}),r.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:3})}))):"MultiLineString"==t?(i=this.fromLonLat(i,3),r=new ol.Feature({geometry:new ol.geom.MultiLineString(i),name:o}),r.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:3})}))):(e.starts(n,"#")&&(n=this.hexToRgba(n,"0.4")),i=this.fromLonLat(i,4),r=new ol.Feature({geometry:new ol.geom.MultiPolygon(i),name:o}),r.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:"black",width:1}),fill:new ol.style.Fill({color:n})}))),this.polFea.push(r),this.polSrc&&this.polLay?this.polSrc.addFeature(r):(this.polSrc=new ol.source.Vector({features:this.polFea}),this.polLay=new ol.layer.Vector({source:this.polSrc}),this.map.addLayer(this.polLay))},i.prototype.fromLonLat=function(t,e){if(void 0===e&&(e=1),1==e){var i=ol.proj.fromLonLat(t)
t[0]=i[0],t[1]=i[1]}else if(2==e)for(var o=0,n=t;o<n.length;o++){var r=n[o],i=ol.proj.fromLonLat(r)
r[0]=i[0],r[1]=i[1]}else if(3==e)for(var a=0,s=t;a<s.length;a++)for(var r=s[a],l=0,p=r;l<p.length;l++){var h=p[l],i=ol.proj.fromLonLat(h)
h[0]=i[0],h[1]=i[1]}else if(4==e)for(var u=0,c=t;u<c.length;u++)for(var r=c[u],d=0,f=r;d<f.length;d++)for(var h=f[d],g=0,m=h;g<m.length;g++){var v=m[g],i=ol.proj.fromLonLat(v)
v[0]=i[0],v[1]=i[1]}return t},i}(WUX.WComponent)
t.OLMap=i}(APP||(APP={}))
var APP
!function(t){var e=WUX.WIcon,i=function(){function t(){}return t.OK="OK",t.CLOSE="Chiudi",t.NEW="Nuovo",t.OPEN="Modifica",t.DELETE="Elimina",t.SAVE="Salva",t.SEND="Invia",t.SEND_EMAIL="Email",t.FIND="Cerca",t.FORCE="Forza",t.SEARCH="Cerca",t.CANCEL="Annulla",t.RESET="Annulla",t.PRINT="Stampa",t.PRINT_ALL="Stampa Tutto",t.PREVIEW="Anteprima",t.EXPORT="Esporta",t.IMPORT="Importa",t.HELP="Guida",t.VIEW="Vedi",t.ENABLE="Abilita",t.DISABLE="Disabilita",t.ADD="Aggiungi",t.APPLY="Applica",t.REMOVE="Rimuovi",t.REMOVE_ALL="Rim.Tutto",t.REFRESH="Aggiorna",t.UNDO="Annulla",t.SETTINGS="Impostazioni",t.COPY="Copia",t.CUT="Taglia",t.PASTE="Incolla",t.CONFIRM="Conferma",t.FORWARD="Avanti",t.BACKWARD="Indietro",t.NEXT="Prossimo",t.PREVIOUS="Precedente",t.SELECT="Seleziona",t.SELECT_ALL="Sel.Tutto",t.WORK="Lavora",t.AGGREGATE="Aggrega",t.SET="Imposta",t.DEFAULT="Predefinito",t.REWORK="Rielabora",t.PUSH="Spedisci",t.SUSPEND="Sospendi",t.RESUME="Riattiva",t.CODE="Codice",t.DESCRIPTION="Descrizione",t.GROUP="Gruppo",t.ROLE="Ruolo",t.TYPE="Tipo",t}()
t.TXT=i
var o=function(){function t(){}return t.CONF_DELETE="Eliminare l'elemento selezionato?",t.CONF_DISABLE="Disabilitare l'elemento selezionato?",t.CONF_ENABLE="Abilitare l'elemento selezionato?",t.CONF_CANCEL="Si vogliono annullare le modifiche apportate?",t.CONF_PROCEED="Si vuole procedere con l'operazione?",t.CONF_OVERWRITE="Si vuole procedere con la sovrascrittura?",t.MSG_COMPLETED="Operazione completata con successo.",t.MSG_ERRORS="Errore durante l'elaborazione.",t}()
t.MSG=o
var n=function(){function t(){}return t.TRUE=e.CHECK_SQUARE_O,t.FALSE=e.SQUARE_O,t.CLOSE=e.TIMES,t.OK=e.CHECK,t.CALENDAR=e.CALENDAR,t.AGGREGATE=e.CHAIN,t.NEW=e.PLUS_SQUARE_O,t.EDIT=e.EDIT,t.OPEN=e.EDIT,t.DELETE=e.TRASH,t.DETAIL=e.FILE_TEXT_O,t.SAVE=e.CHECK,t.FIND=e.SEARCH,t.FIND_DIFF=e.SEARCH_MINUS,t.FIND_PLUS=e.SEARCH_PLUS,t.FORCE=e.CHECK_CIRCLE,t.FORCE_ALL=e.CHECK_CIRCLE_O,t.SEARCH=e.SEARCH,t.CANCEL=e.UNDO,t.RESET=e.TIMES_CIRCLE,t.PRINT=e.PRINT,t.PREVIEW=e.SEARCH_PLUS,t.EXPORT=e.SHARE_SQUARE_O,t.IMPORT=e.SIGN_IN,t.FILE=e.FILE_O,t.HELP=e.QUESTION_CIRCLE,t.VIEW=e.FILE_TEXT_O,t.ENABLE=e.THUMBS_O_UP,t.DISABLE=e.THUMBS_O_DOWN,t.ADD=e.PLUS,t.APPLY=e.CHECK,t.REMOVE=e.MINUS,t.REFRESH=e.REFRESH,t.UNDO=e.UNDO,t.SETTINGS=e.COG,t.OPTIONS=e.CHECK_SQUARE,t.PASSWORD=e.UNDO,t.COPY=e.COPY,t.CUT=e.CUT,t.PASTE=e.PASTE,t.FORWARD=e.ANGLE_DOUBLE_RIGHT,t.BACKWARD=e.ANGLE_DOUBLE_LEFT,t.NEXT=e.FORWARD,t.PREVIOUS=e.BACKWARD,t.CONFIRM=e.CHECK,t.FILTER=e.FILTER,t.SEND=e.SEND,t.SEND_EMAIL=e.ENVELOPE_O,t.WAIT=e.COG,t.WORK=e.COG,t.CONFIG=e.COG,t.LEFT=e.ARROW_CIRCLE_LEFT,t.RIGHT=e.ARROW_CIRCLE_RIGHT,t.SELECT_ALL=e.TH_LIST,t.REWORK=e.REFRESH,t.PUSH=e.TRUCK,t.AHEAD=e.ANGLE_DOUBLE_RIGHT,t.SUSPEND=e.TOGGLE_OFF,t.RESUME=e.RECYCLE,t.PAIRING=e.RANDOM,t.CHECK=e.CHECK_SQUARE_O,t.EVENT=e.BOLT,t.MESSAGE=e.ENVELOPE_O,t.USER=e.USER_O,t.GROUP=e.USERS,t.TOOL=e.WRENCH,t.DEMOGRAPHIC=e.ADDRESS_CARD,t.DOCUMENT=e.FILE_TEXT_O,t.LINKS=e.CHAIN,t.WARNING=e.WARNING,t.INFO=e.INFO_CIRCLE,t.CRITICAL=e.TIMES_CIRCLE,t}()
t.ICO=n}(APP||(APP={}))
var APP
!function(t){var e=function(e){function i(t){var i=e.call(this,t||"*","GUISample")||this
return i._ma=["ragioneSociale","email"],i}return __extends(i,e),i.prototype.render=function(){var e,i=this
return this.fpMain=new WUX.WFormPanel("fpMain"),this.fpMain.addRow(),this.fpMain.addTextField("ragioneSociale","Ragione Sociale"),this.fpMain.addRow(),this.fpMain.addTextField("email","Email"),this.fpMain.addTextField("telefono","Telefono"),(e=this.fpMain).setMandatory.apply(e,this._ma),this.btnSave=new WUX.WButton(this.subId("btnSave"),t.TXT.SAVE,WUX.WIcon.CHECK,WUX.BTN.PRIMARY),this.btnSave.on("click",function(e){var o=i.fpMain.getRoot()
i.initValidator(o)
var n=!o.valid()
if(n&&t.scrollTo(i.fpMain),n)return void WUX.showWarning("Controllare i valori immessi")
var r=i.fpMain.checkMandatory(!0,!0,!1)
if(r)return void WUX.showWarning("Specificare i seguenti campi: "+r)
$(window).scrollTop(0)
var a=new t.APPArticle("art-sample","Sample")
a.addSignature=!0
var s=[]
s.push("La ringraziamo per il tempo dedicato."),a.setState(s)
var l=WUX.getPageTitle()
l&&l.length&&l.hide(),WuxDOM.replace(i,a)}),this.container=new WUX.WContainer,this.container.addRow().addCol("col-md-12").section("Dati principali").add(this.fpMain).addRow().addCol("col-md-12",{a:"center",pt:16}).add(this.btnSave),this.container},i.prototype.componentDidMount=function(){this.initValidator(this.fpMain.getRoot())},i.prototype.initValidator=function(t,e){t&&t.length&&(t.removeData("validator"),this.jqv=t.validate({ignore:null,rules:{"fpMain-ragioneSociale":{required:!0},"fpMain-email":{required:!0,email:!0},"fpMain-telefono":{required:!1,minlength:6,maxlength:15,digits:!0}}}),e&&this.jqv.resetForm())},i}(WUX.WComponent)
t.GUISample=e}(APP||(APP={}))
